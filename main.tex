\documentclass[openany]{book}

\usepackage{fontspec}
\usepackage{paralist}
\usepackage{wallpaper}
\usepackage{color}
\usepackage{xunicode}
\usepackage{xltxtra}
\usepackage{graphicx}
\usepackage[margin=3cm]{geometry}
\usepackage{type1cm}
\usepackage{parskip}
\usepackage[fleqn]{amsmath}
\usepackage{amsthm}
\usepackage{url}
\usepackage{makeidx}
\usepackage[normalem]{ulem}
\usepackage{fancyvrb}
\usepackage{wasysym}


\setmonofont[SizeFeatures={Size={9}}]{Monaco}
\newfontfamily\msjh{Microsoft JhengHei}
\newfontfamily\kai{BiauKai}
\newfontfamily\arial{Arial}

\XeTeXlinebreaklocale "zh"
\DefineVerbatimEnvironment{code}{Verbatim}{fontsize=\small,frame=leftline,numbers=left,commandchars=\\\{\}}
\setlength{\parskip}{1em plus0.2em minus0em}
\pagestyle{plain}
\makeindex

\newcommand{\overPartialT}{\frac{\partial}{\partial t}}

\newcommand{\curlH}{\nabla\times H}
\newcommand{\curlE}{\nabla\times \widetilde{E}}

\newcommand{\curlHxThree}{\left( \frac{\partial H_z}{\partial y} - \frac{\partial H_y}{\partial z} \right)}
\newcommand{\curlHyThree}{\left( \frac{\partial H_x}{\partial z} - \frac{\partial H_z}{\partial x} \right)}
\newcommand{\curlHzThree}{\left( \frac{\partial H_y}{\partial x} - \frac{\partial H_x}{\partial y} \right)}

\newcommand{\curlExThree}{\left(\frac{\partial \widetilde{E}_z}{\partial y} - \frac{\partial \widetilde{E}_y}{\partial z}\right)}
\newcommand{\curlEyThree}{\left(\frac{\partial \widetilde{E}_x}{\partial z} - \frac{\partial \widetilde{E}_z}{\partial x}\right)}
\newcommand{\curlEzThree}{\left(\frac{\partial \widetilde{E}_y}{\partial x} - \frac{\partial \widetilde{E}_x}{\partial y}\right)}

\newcommand{\curlHxTwo}{\left(  \frac{\partial H_z}{\partial y}\right)}
\newcommand{\curlHyTwo}{\left(- \frac{\partial H_z}{\partial x}\right)}
\newcommand{\curlHzTwo}{\left(  \frac{\partial H_y}{\partial x} - \frac{\partial H_x}{\partial y}\right)}

\newcommand{\curlExTwo}{\left(  \frac{\partial \widetilde{E}_z}{\partial y}\right)}
\newcommand{\curlEyTwo}{\left(- \frac{\partial \widetilde{E}_z}{\partial x}\right)}
\newcommand{\curlEzTwo}{\left(  \frac{\partial \widetilde{E}_y}{\partial x} - \frac{\partial \widetilde{E}_x}{\partial y}\right)}

\begin{document}
\fontsize{12}{2.0em}\selectfont


\frontmatter

\input{frontmatter/cover}
\input{frontmatter/acknowledgement}
\input{frontmatter/abstract}
\tableofcontents





\mainmatter

\chapter{Introduction}
\input{introduction/motivations}
\input{introduction/chapter-outline}


\chapter{The Finite-Difference Time-Domain Method}
\input{the-finite-difference-time-domain-method/the-algorithm}
\input{the-finite-difference-time-domain-method/sources}
\input{the-finite-difference-time-domain-method/boundary-conditions}
\input{the-finite-difference-time-domain-method/dispersive-material}
\input{the-finite-difference-time-domain-method/modeling-of-object}
%% \input{the-finite-difference-time-domain-method/transmittance-spectrum}
\clearpage
\begin{center}
\includegraphics[scale=0.5]{images/yee-grid.jpg}\\
Fig 2.1
Illustraction of one Yee Grid used in this thesis
\end{center}

\begin{center}
\includegraphics[scale=0.5]{images/tfsf.jpg}\\
Fig 2.2
Configuration of Total Field / Scatter Field 
\end{center}

\begin{center}
\includegraphics[scale=0.5]{images/pbc.jpg}\\
Fig 2.3
Configuration of Periodic Boundary Conditions
\end{center}



\chapter{The yaFDTD Framework}
\input{the-yafdtd-framework/yet-another-fdtd-framework}
\input{the-yafdtd-framework/once-decorator}
\input{the-yafdtd-framework/freespace-component}
\input{the-yafdtd-framework/pbc-component}
\input{the-yafdtd-framework/upml-component}
\input{the-yafdtd-framework/tfsf-component}
\input{the-yafdtd-framework/dispersion-component}
\input{the-yafdtd-framework/mpi-edge-component}
\clearpage
\begin{center}
\includegraphics[scale=0.5]{images/once-decorator.jpg}\\
Fig 3.1
Inheritance relationship in Once Decorator Pattern
\end{center}
\begin{center}
\includegraphics[scale=0.5]{images/once-decorator-yafdtd.png}\\
Fig 3.2
Inheritance relationship in yaFDTD framework
\end{center}
\begin{center}
\includegraphics[scale=0.5]{images/tfsf-pbc.jpg}\\
Fig 3.3
Possible configurations of Total Field / Scatter Field Component for x-incident and y-incident source conditions
\end{center}



\chapter{Applications about Surface Plasmon Structures}
\input{applications-about-surface-plasmon-structures/examination}
\input{applications-about-surface-plasmon-structures/silver-rods-open-cavity}
\clearpage
\begin{center}
\includegraphics[scale=0.5]{images/single-rod-config.jpg}\\
Fig 4.1
configuration of single silver rods
\end{center}
\begin{center}
\includegraphics[scale=0.8]{images/phasor-exam-fdtd.png}\\
Fig 4.2
phasor distribution of $mathrm{H_z}$, calculated by yaFDTD
\end{center}
\begin{center}
\includegraphics[scale=0.8]{images/phasor-exam-exact.png}\\
Fig 4.3
phasor distribution of $mathrm{H_z}$, exact solution
\end{center}
\begin{center}
\includegraphics[scale=0.8]{images/errors.png}\\
Fig 4.4
numerical error between yaFDTD and exact solution
\end{center}

%% open cavity
\begin{center}
\includegraphics[scale=0.5]{images/open-cavity-config.jpg}\\
Fig 4.5
configuration of three pairs of silver nanocylinders
\end{center}

\begin{center}
\includegraphics[scale=0.8]{images/etotal.png}\\
Fig 4.6
phasor distribution of $|E|$ for the case $\lambda = 460nm, r = 36nm, d = d_p = 20nm$, calculated by yaFDTD
\end{center}
\begin{center}
\includegraphics[scale=0.5]{images/r36.png}\\
Fig 4.7
phasor distribution of $|E|$ for the case $\lambda = 460nm, r = 36nm, d = d_p = 20nm$, in previous study
\end{center}
\begin{center}
\includegraphics[scale=0.8]{images/ex.png}\\
Fig 4.8
phasor distribution of $|E_x|$ for the case $\lambda = 460nm, r = 36nm, d = d_p = 20nm$, calculated by yaFDTD
\end{center}

\begin{center}
\includegraphics[scale=0.8]{images/ey.png}\\
Fig 4.9
phasor distribution of $|E_y|$ for the case $\lambda = 460nm, r = 36nm, d = d_p = 20nm$, calculated by yaFDTD
\end{center}


%% r58
\begin{center}
\includegraphics[scale=0.5]{images/open-cavity-config-r58.png}\\
Fig 4.10
configuration of three pairs of silver nanocylinders
\end{center}

\begin{center}
\includegraphics[scale=0.8]{images/etotal-r58.png}\\
Fig 4.11
phasor distribution of $|E|$ for the case $\lambda = 650nm, r = 58nm, d = d_p = 20nm$, calculated by yaFDTD
\end{center}

\begin{center}
\includegraphics[scale=0.5]{images/r58.png}\\
Fig 4.12
phasor distribution of $|E|$ for the case $\lambda = 650nm, r = 58nm, d = d_p = 20nm$, in previous study
\end{center}

\begin{center}
\includegraphics[scale=0.8]{images/ex-r58.png}\\
Fig 4.13
phasor distribution of $|E_x|$ for the case $\lambda = 650nm, r = 58nm, d = d_p = 20nm$, calculated by yaFDTD
\end{center}

\begin{center}
\includegraphics[scale=0.8]{images/ey-r58.png}\\
Fig 4.14
phasor distribution of $|E_y|$ for the case $\lambda = 650nm, r = 58nm, d = d_p = 20nm$, calculated by yaFDTD
\end{center}


%% d40
\begin{center}
\includegraphics[scale=0.5]{images/open-cavity-config-d40.png}\\
Fig 4.15
configuration of three pairs of silver nanocylinders, $d = 20nm, d_p = 40nm$
\end{center}

\begin{center}
\includegraphics[scale=0.8]{images/etotal-d40.png}\\
Fig 4.16
phasor distribution of $|E|$ for the case $\lambda = 460nm, r = 36nm, d = 20nm, d_p = 40nm$, calculated by yaFDTD
\end{center}

\begin{center}
\includegraphics[scale=0.5]{images/d40.png}\\
Fig 4.17
phasor distribution of $|E|$ for the case $\lambda = 650nm, r = 58nm, d = d_p = 20nm$, in previous study
\end{center}

\begin{center}
\includegraphics[scale=0.8]{images/ex-d40.png}\\
Fig 4.18
phasor distribution of $|E_x|$ for the case $\lambda = 460nm, r = 36nm, d = 20nm, d_p = 40nm$, calculated by yaFDTD
\end{center}

\begin{center}
\includegraphics[scale=0.8]{images/ey-d40.png}\\
Fig 4.19
phasor distribution of $|E_y|$ for the case $\lambda = 460nm, r = 36nm, d = 20nm, d_p = 40nm$, calculated by yaFDTD
\end{center}




\chapter{Conclusion}
In this research, Maxwell's equations are reinvestigated to be a more symmetrical forms for being programmable easily
and the possibility to refactor Maxwell's equtions into a bunch of fragments is also be studied. By importing the
concepts of Structural Programming and Object-Oriented Programming, a blueprint of forming a FDTD simulator by assembling
well-prepared components appears before our eyes. It admits the newbies starting simulations without understanding details
of each component. For designing five common components in the FDTD method: Free-space, Perfectly Matched Layers, Dispersive
Materials, Total Field / Scatter Field plane wave source, and Bloch Periodic Boundary Conditions, fragments of Maxwell's
equations are spreaded into different classes. For assembling all components well, a Design Pattern, Once Decorator, is
proposed. By the abilities of this Design Pattern, It is possible to append or exchange new components into future
simulation without considerable changes in other components which have been written. Existing five components are also gathered
as a tiny framework.

The structures formed of silver nanocylinders are also studied. In the single silver rod case, the phasor distribution
calculated by the FDTD method is compared with exact solution. This case shows that the accuracy of the tiny framework is
credible. An open cavity forms of three silver nanocylinders pairs are also studied. Field phasor calculation shows the open
cavity has the maximum resonance when the ratio of the wevelength of the impinging plane wave and the radius of nanocylinders is
around 11 and 12. Phasor distributions of $|\mathrm{E_x}|$ and $|\mathrm{E_y}|$ also show the details of
dipole interaction. It implies with increasing distance between pairs, $|\mathrm{E_y}|$ would be weakened and $|\mathrm{E_x}|$
has the same change when the distance inside each pair increases due to less coupling of near-field.




%% \appendix
%% \chapter{Comparing ADE, RC and ZT}
%% \input{appendix/three-ways-to-debye-model}


\backmatter
\input{backmatter/bibliography}
%% \input{backmatter/index}

\end{document}
