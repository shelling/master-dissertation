\section{Dispersive Material}
This section conerns of how to retrieve the update equations could apply in dispersive material. What would be discussed
below are only about material having dispersive electic permittivity. The material having dispersive magnetic
permeability could be investigated via duality.

In fundamental Electromagnetics, an indispersive material having a electrical polarization $P$ when there is a foreign
electric field and the phasor of electric flux would become $D(\omega) = \epsilon_0 E(\omega) + P$. $P$ was also defined
as $\epsilon_0 \chi_e E(\omega)$, so that we could rewrite $D(\omega)$ as $\epsilon_0 (1+\chi_e)E(\omega)$ and give the middle term a notation
$\epsilon_r$ named relative permittivity.

By definition, dispersive material is the material having different electic permeability when encountering EM wave
having different frequency that means the relative permittivity should be a function of frequency ordinarily coming with
image part. So, $\epsilon_r^*(\omega)$ was given as the notation of dispersive electic permittivity and the phasor of
electic flux in dispersive material was defined as $D(\omega) = \epsilon_0 \epsilon_r^*(\omega)E(\omega)$.
\subsection{Common Isotropic Dispersive Material}
The dispersive permittivity is defined as $\epsilon_r^*(\omega) = \epsilon_{\infty} + \chi_p(\omega)$, where
$\epsilon_{\infty}$ is ... and $\chi_p(\omega)$ is ...

\subsubsection{Debye Media}
\begin{equation}
  \chi_p(\omega) = \frac{\Delta\epsilon_p}{1+j\omega\tau_p}  
\end{equation}
\begin{equation}
  \chi_p(t) = \frac{\Delta \epsilon_p}{\tau_p} e^{-\frac{t}{\tau_p}}U(t)  
\end{equation}
\begin{equation}
  \epsilon_r(\omega) = \epsilon_{\infty} + \sum_{p=1}^P \frac{\Delta\epsilon_p}{1+j\omega\tau_p}  
\end{equation}



\subsubsection{Lorentz Media}
\begin{equation}
  \chi_p(\omega) = \frac{\Delta\epsilon_p\omega_p^2}{\omega_p^2 + 2j\omega\delta_p - \omega^2}  
\end{equation}
\begin{equation}
  \chi_p(t) = \frac{\Delta \epsilon_p \omega_p^2}{\sqrt{\omega_p^2 - \delta_p^2}}e^{-\delta_p t}\sin\left(\sqrt{\omega_p^2-\delta_p^2}\ t\right)U(t)
\end{equation}
\begin{equation}
  \epsilon_r(\omega) = \epsilon_{\infty} + \sum_{p=1}^P \frac{\Delta\epsilon_p\omega_p^2}{\omega_p^2 + 2j\omega\delta_p - \omega^2}  
\end{equation}


\subsubsection{Drude Media}
\begin{equation}
  \chi_p(\omega) = -\frac{\omega_p^2}{\omega^2 - j\omega\gamma_p}  
\end{equation}
\begin{equation}
  \chi_p(t) = -\frac{\omega_p^2}{\gamma_p}\left(1-e^{-\gamma_p t}\right) U(t)
\end{equation}
where U(t) is Heaviside
The single pole permittivity is 
\begin{equation}
  \epsilon_r(\omega) = \epsilon_{\infty} - \sum_{p=1}^P \frac{\omega_p^2}{\omega(\omega-j\gamma_p)}
\end{equation}
where $\omega_p$ is the Drude pole frequency and $\gamma_p$ is the inverse of the pole relaxation time, also known as the
electron oscillision frequency.



\subsection{Dispersion-Compatible Update Equations}
In this section, we would introduce three algorithm to adjust the update equations to suit the dispersive material shown
above.

We would see that the update equations would have the same forms after transformming no matter which way we choose. It
means, for some problems convenient to apply specified algorithm but not easy to apply another one, 

\subsubsection{The Piecewise-Linear Recursive Convolution Method}
Piecewise-Linear Recursive Convolution (PLRC) Method

Apply PLRC to frequency-independent material having definition as
\begin{displaymath}
  \epsilon_r^{*}(\omega) = \epsilon_{\infty} + \frac{\sigma}{j \omega \epsilon_0}
\end{displaymath}
\begin{displaymath}
  \begin{split}
    D(\omega) & = \epsilon_0 \epsilon_r^{*}(\omega) E(\omega)\\
    & = \epsilon_0 \epsilon_{\infty} E(\omega) + \frac{\sigma}{j\omega}E(\omega)
  \end{split}
\end{displaymath}
\begin{displaymath}
  D(t) = \epsilon_0 \epsilon_{\infty}E(t) + \sigma \int_0^t E(t')dt'
\end{displaymath}
\begin{displaymath}
  \begin{split}
    D^n & = \epsilon_0 \epsilon_{\infty} E^n + \sigma \Delta t \sum_{i=0}^{n}E^i\\
    & = \epsilon_0 \epsilon_{\infty} E^n + \sigma \Delta t E^n + \sigma \Delta t \sum_{i=0}^{n-1}E^i\\
    & = (\epsilon_0 \epsilon_{\infty} + \sigma \Delta t) E^n + \sigma \Delta t \sum_{i=0}^{n-1}E^i
  \end{split}
\end{displaymath}
\begin{displaymath}
  E^n = \frac{\displaystyle D^n - \sigma \Delta t \sum_{i=0}^{n-1}E^i}{\epsilon_0 \epsilon_{\infty} + \sigma \Delta t}
\end{displaymath}
\begin{gather*}
  E^n = \frac{D^n - I^n}{\epsilon_0 \epsilon_{\infty} + \sigma \Delta t}\\
  I^n = I^{n-1} + \sigma \Delta t\ E^n
\end{gather*}

\paragraph{{\msjh Debye Model - PLRC}}
\begin{displaymath}
  \epsilon_r^*(\omega) = \epsilon_{\infty} + \frac{\sigma}{j\omega \epsilon_0} + \frac{\Delta \epsilon_p}{1+j\omega \tau_p}
\end{displaymath}
\begin{displaymath}
  \begin{split}
    D(\omega) & = \epsilon_0 \epsilon_r^*(\omega) E(\omega)\\
    & = \epsilon_0 \epsilon_{\infty} E(\omega) + \frac{\sigma}{j\omega} E(\omega) + \frac{\Delta \epsilon_p}{1+j\omega \tau_p}E(\omega)
  \end{split}
\end{displaymath}
\begin{displaymath}
  D(t) = \epsilon_0 \epsilon_{\infty} E(t) + \sigma \int_0^t E(t')dt' + \epsilon_0 \int_0^t \frac{\Delta \epsilon_p}{\tau_p}e^{-\frac{t'-t}{\tau_p}}E(t')dt'
\end{displaymath}
\begin{displaymath}
  \begin{split}
    D^n & = \epsilon_0 \epsilon_{\infty}E^n + \sigma \Delta t \sum_{i=0}^{n}E^i + \epsilon_0 \frac{\Delta \epsilon_p}{\tau_p}\Delta t \sum_{i=0}^{n} e^{-\frac{n-i}{\tau_p}\Delta t} E^i\\
    & = \epsilon_0 \epsilon_{\infty} E^n + \left[\sigma \Delta t\ E^n + \sigma \Delta t \sum_{i=0}^{n-1}E^i\right]\\
    &\quad + \left[\epsilon_0 \frac{\Delta \epsilon_p}{\tau_p}\Delta t\ E^n + \epsilon_0 \frac{\Delta \epsilon_p}{\tau_p} \Delta t \sum_{i=0}^{n-1}e^{-\frac{n-i}{\tau_p}\Delta t}E^i\right]\\
    & = \left(\epsilon_0 \epsilon_{\infty} + \sigma \Delta t + \epsilon_0 \frac{\Delta \epsilon_p}{\tau_p} \Delta t\right)E^n + \sigma \Delta t \sum_{i=0}^{n-1}E^i + \epsilon_0 \frac{\Delta \epsilon_p}{\tau_p}\Delta t \sum_{i=0}^{n-1}e^{-\frac{n-i}{\tau_p}\Delta t}E^i
  \end{split}
\end{displaymath}
\begin{displaymath}
  \begin{split}
    E^n & = \frac{\displaystyle D^n - \sigma \Delta t \sum_{i=0}^{n-1}E^i - \epsilon_0 \frac{\Delta \epsilon_p}{\tau_p}\Delta t \sum_{i=0}^{n-1}e^{-\frac{n-i}{\tau_p}\Delta t}E^i }{\displaystyle\epsilon_0 \epsilon_{\infty} + \sigma \Delta t + \epsilon_0 \frac{\Delta \epsilon_p}{\tau_p} \Delta t}\\
    & = \frac{\displaystyle D^n - I^{n-1} - J^{n-1} }{\displaystyle\epsilon_0 \epsilon_{\infty} + \sigma \Delta t + \epsilon_0 \frac{\Delta \epsilon_p}{\tau_p} \Delta t}\\
  \end{split}
\end{displaymath}





\paragraph{{\msjh Lorentz Model - PLRC}}

\paragraph{{\msjh Drude Model - PLRC}}

\subsubsection{The Auxiliary Differential Equation Method}
The 

By defining the $\chi$-related term as the phasor polorization current $J_p(\omega)$.
\paragraph{{\msjh Debye Model - ADE}}
\begin{equation}
  \begin{split}
    \nabla \times H & = j\omega D(\omega)\\
    & = j\omega \epsilon_0\epsilon_r^*(\omega)E(\omega)\\
    & = j\omega \epsilon_0 \epsilon_{\infty}E(\omega) + \sigma E(\omega) + j\omega \epsilon_0 \frac{\Delta \epsilon_p}{1+j\omega \tau_p}E(\omega)
  \end{split}
\end{equation}
\begin{equation}
  J_p(\omega) = j\omega \epsilon_0 \frac{\Delta \epsilon_p}{1+j\omega \tau_p}E(\omega)
\end{equation}


\paragraph{{\msjh Lorentz Model - ADE}}
\begin{equation}
  \begin{split}
    \nabla \times H & = j\omega D(\omega)\\
    & = j\omega \epsilon_0\epsilon_r^*(\omega)E(\omega)\\
    & = j\omega \epsilon_0\epsilon_{\infty}E(\omega) + j\omega \frac{\Delta \epsilon_p \omega_p^2}{\omega_p^2+2j\omega\delta_p-\omega^2}E(\omega)
  \end{split}
\end{equation}

\paragraph{{\msjh Drude Model - ADE}}
\begin{equation}
  \begin{split}
    \nabla \times H & = j\omega D(\omega)\\
    & = j\omega \epsilon_0\epsilon_r^*(\omega)E(\omega)\\
    & = j\omega \epsilon_0 \epsilon_{\infty} E(\omega) - j\omega \epsilon_0\frac{\omega_p^2}{\omega(\omega-j\gamma_p)}E(\omega)
  \end{split}
\end{equation}
Defining the last term as $J_p$, the phasor polarization current in physics,
\begin{equation}
  J_p(\omega) = -j\omega\epsilon_0\frac{\omega_p^2}{\omega(\omega-j\gamma_p)}E(\omega)
\end{equation}
Rearrange
\begin{equation}
  \omega^2J_p(\omega) - j\omega\gamma_pJ_p(\omega) = -j\omega\epsilon_0\omega_p^2 E(\omega)
\end{equation}
Performming inverse Fourier transformation
\begin{equation}
  \frac{\partial^2 J_p}{\partial t^2} + \gamma_p \frac{\partial J_p}{\partial t} = \epsilon_0\omega_p^2\frac{\partial E}{\partial t}
\end{equation}
Integrating once
\begin{equation}
  \frac{\partial J_p}{\partial t} + \gamma_p J_p = \epsilon_0 \omega_p^2 E(\omega)
\end{equation}
This is the ADE for $J_p$ for Drude Model

Apply the semi-implicit scheme
\begin{equation}
  \left(\frac{J_p^{n+1} - J_p^n}{\Delta t}\right) + \gamma_{p}\left(\frac{J_p^{n+1} + J_p^n}{2}\right) = \epsilon_0\omega_p^2\left(\frac{E^{n+1} + E^n}{2}\right)
\end{equation}
Solving
\begin{equation}
  J_p^{n+1} = \left(\frac{1-\gamma_p\Delta t /2}{1+\gamma_p\Delta t /2}\right)J_p^n + \left(\frac{\omega_p^2\epsilon_0\Delta t /2}{1+\gamma_p\Delta t /2}\right)\left(E^{n+1}+E^n\right)
\end{equation}
\begin{equation}
  \begin{split}
    E^{n+1} & = \left(\frac{2\epsilon_0\epsilon_{\infty} - \Delta t \beta_p}{2\epsilon_0\epsilon_{\infty} + \Delta t \beta_p}\right)E^n \\
    & + \left(\frac{2\Delta t}{2\epsilon_0\epsilon_{\infty} + \Delta t \beta_p}\right)\left(\nabla\times H^{n+1/2} - \frac{1}{2}(1+k_p)J_p^n\right)
  \end{split}
\end{equation}



\subsubsection{The Z Transform Method}
\paragraph{Debye Model - ZT}

\paragraph{Lorentz Model - ZT}

\paragraph{Drude Model - ZT}
